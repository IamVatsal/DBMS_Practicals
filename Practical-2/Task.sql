-- PROMPT 24012011142_Vatsal [\d] \D \n>
-- tee c:/Users/Lenovo/Desktop/DBMS/DBMS_Practicals/Practical-1/Task.txt

CREATE DATABASE Practical_1_24012011142;

USE Practical_1_24012011142;

CREATE TABLE ACCOUNT_24012011142 (
    acc_no VARCHAR(5) PRIMARY KEY,
    Name VARCHAR(30),
    City VARCHAR(20),
    Balance DECIMAL(10, 2),
    loan_taken VARCHAR(5)
);

DESC ACCOUNT_24012011142;

INSERT INTO ACCOUNT_24012011142 (acc_no, Name, City, Balance, loan_taken) VALUES
('A001', 'Patel Jigar', 'Mehsana', 50000, 'YES'),
('A002', 'Patel Ramesh', 'Mehsana', 50000, 'YES'),
('A003', 'Dave Hardik', 'Ahmedabad', 75000, 'NO'),
('A004', 'Soni Hetal', 'Ahmedabad', 100000, 'NO'),
('A005', 'Sony Atul', 'Vadodara', 100000, 'YES');

SELECT * FROM ACCOUNT_24012011142;

CREATE TABLE LOAN_24012011142 (
    loan_no VARCHAR(5) PRIMARY KEY,
    acc_no VARCHAR(5),
    loan_amt DECIMAL(10, 2),
    interest_rate DECIMAL(5, 2),
    loan_date DATE,
    remaining_loan DECIMAL(10, 2)
);

DESC LOAN_24012011142;

INSERT INTO LOAN_24012011142 (loan_no, acc_no, loan_amt, interest_rate, loan_date, remaining_loan) VALUES
('L001', 'A001', 100000, 7, '2004-01-01', 75000),
('L002', 'A002', 300000, 9, '2004-05-18', 150000),
('L003', 'A005', 500000, 11, '2004-06-15', 300000);

SELECT * FROM LOAN_24012011142;

CREATE TABLE INSTALLMENT_24012011142 (
    loan_no VARCHAR(5),
    installment_no VARCHAR(5) PRIMARY KEY,
    installment_date DATE,
    Amount DECIMAL(10, 2)
);

DESC INSTALLMENT_24012011142;

INSERT INTO INSTALLMENT_24012011142 (loan_no, installment_no, installment_date, Amount) VALUES
('L001', 'I001', '2004-02-02', 15000),
('L002', 'I002', '2004-06-18', 20000),
('L003', 'I003', '2004-07-15', 20000);

SELECT * FROM INSTALLMENT_24012011142;

-- 1.
SELECT * FROM INSTALLMENT_24012011142;
-- 2.
SELECT loan_no, installment_no, Amount FROM INSTALLMENT_24012011142;
-- 3.
SELECT acc_no, Name FROM ACCOUNT_24012011142 WHERE City = 'Ahmedabad';
-- 4.
SELECT * FROM LOAN_24012011142 WHERE loan_amt > 100000;
-- 5.
DESCRIBE ACCOUNT_24012011142;
DESCRIBE LOAN_24012011142;
DESCRIBE INSTALLMENT_24012011142;
-- 6.
SELECT * FROM ACCOUNT_24012011142;
UPDATE ACCOUNT_24012011142 SET Name = 'Patel Hiren' WHERE Name = 'Patel Jigar';
SELECT * FROM ACCOUNT_24012011142;
-- 7.
SELECT * FROM ACCOUNT_24012011142;
UPDATE ACCOUNT_24012011142 SET Name = 'Kothari Nehal' , City = 'Kherva' WHERE acc_no = 'A005';
SELECT * FROM ACCOUNT_24012011142;
-- 8.
SELECT * FROM ACCOUNT_24012011142 WHERE loan_taken = 'YES';
-- 9.
DESCRIBE ACCOUNT_24012011142;
ALTER TABLE ACCOUNT_24012011142 ADD COLUMN address VARCHAR(20);
DESCRIBE ACCOUNT_24012011142;
-- 10.
DESC LOAN_24012011142;
ALTER TABLE LOAN_24012011142 ADD COLUMN credit_no VARCHAR(4);
DESC LOAN_24012011142;
-- 11.
DESC ACCOUNT_24012011142;
CREATE TABLE ACCOUNT_TEMP AS SELECT acc_no, Name, Balance FROM ACCOUNT_24012011142;
DESC ACCOUNT_TEMP;
-- 12.
DESC LOAN_24012011142;
CREATE TABLE LOAN_TEMP AS SELECT loan_no, acc_no, loan_amt, loan_date FROM LOAN_24012011142;
DESC LOAN_TEMP;
-- 13.
DESC ACCOUNT_24012011142;
CREATE TABLE TRANS_TEMP AS SELECT loan_no, acc_no AS account_number, loan_amt, loan_date FROM LOAN_TEMP;
DESC TRANS_TEMP;
-- 14.
DESC LOAN_24012011142;
ALTER TABLE LOAN_24012011142 MODIFY acc_no VARCHAR(7);
DESC LOAN_24012011142;
-- 15.
SELECT * FROM ACCOUNT_24012011142;
DELETE FROM ACCOUNT_24012011142 WHERE acc_no = 'A004';
SELECT * FROM ACCOUNT_24012011142;
-- 16.
SELECT * FROM LOAN_24012011142;
UPDATE LOAN_24012011142 SET interest_rate = interest_rate + 2;
SELECT * FROM LOAN_24012011142;
-- 17.
SELECT * FROM LOAN_24012011142;
SELECT * FROM LOAN_24012011142 WHERE MONTH(loan_date) = 1;
-- 18.
SELECT * FROM INSTALLMENT_24012011142;
UPDATE INSTALLMENT_24012011142 SET installment_date = '2022-03-03' WHERE installment_date = '2021-02-02';
SELECT * FROM INSTALLMENT_24012011142;
-- 19.
SELECT * FROM LOAN_24012011142;
SELECT loan_amt * 2 AS double_loan_amt FROM LOAN_24012011142;
-- 20.
SELECT * FROM LOAN_24012011142;
UPDATE LOAN_24012011142 SET loan_amt = 150000 WHERE loan_no = 'L001';
SELECT * FROM LOAN_24012011142;
-- 21.
SELECT * FROM INSTALLMENT_24012011142;
SELECT loan_no, Amount, installment_date FROM INSTALLMENT_24012011142 ORDER BY installment_date;
-- 22.
SELECT * FROM ACCOUNT_24012011142;
SELECT * FROM ACCOUNT_24012011142 ORDER BY acc_no DESC;
-- 23.
DROP TABLE LOAN_TEMP;






-- Practical-2

-- 1.
ALTER TABLE ACCOUNT_24012011142 ADD COLUMN address VARCHAR(50);
DESC ACCOUNT_24012011142;
ALTER TABLE ACCOUNT_24012011142 DROP COLUMN address;
DESC ACCOUNT_24012011142;
-- 2.
DESC ACCOUNT_24012011142;
ALTER TABLE ACCOUNT_24012011142 RENAME COLUMN Name TO New_name;
DESC ACCOUNT_24012011142;
-- 3.
SELECT * FROM ACCOUNT_24012011142;
SELECT * FROM ACCOUNT_24012011142 WHERE City NOT IN ('Ahmedabad', 'Vadodara');
-- 4.
SELECT * FROM ACCOUNT_24012011142;
SELECT * FROM ACCOUNT_24012011142 WHERE acc_no = 'A001' AND City = 'Mehsana';
-- 5.
SELECT * FROM ACCOUNT_24012011142;
SELECT * FROM ACCOUNT_24012011142 WHERE acc_no = 'A001' OR City = 'Mehsana';
-- 6.
SELECT * FROM ACCOUNT_24012011142;
SELECT * FROM ACCOUNT_24012011142 WHERE Balance BETWEEN 75000 AND 100000;
-- 7.
SELECT * FROM ACCOUNT_24012011142;
SELECT * FROM ACCOUNT_24012011142 WHERE Balance NOT BETWEEN 50000 AND 75000;
-- 8.
SELECT * FROM INSTALLMENT_24012011142;
SELECT * FROM INSTALLMENT_24012011142 WHERE Amount IN (5000, 15000, 30000);
-- 9.
SELECT * FROM INSTALLMENT_24012011142;
SELECT * FROM INSTALLMENT_24012011142 WHERE Amount NOT IN (5000, 15000, 30000);
-- 10.
SELECT * FROM ACCOUNT_24012011142;
SELECT * FROM ACCOUNT_24012011142 WHERE New_name LIKE 'D%';
-- 11.
SELECT
    SYSDATE() AS SystemDate,
    CURDATE() AS CurrentDate,
    NOW() AS NowDateTime
FROM DUAL;
-- 12.
SELECT SYSDATE() + INTERVAL 15 DAY AS DateAfter15Days;
SELECT DATE_ADD(SYSDATE(), INTERVAL 15 DAY) AS DateAfter15Days_Alt;
-- 13.
SELECT SYSDATE() - INTERVAL 20 DAY AS DateBefore20Days;
SELECT DATE_SUB(SYSDATE(), INTERVAL 20 DAY) AS DateBefore20Days_Alt;
-- 14.
SELECT
    5 * 5 AS Multiplication,
    34 + 34 AS Addition,
    LENGTH('uvpce') AS StringLength,
    MONTHNAME(CURDATE()) AS MonthName
FROM DUAL;




-- Practical 2.2
-- Table Creation and Insertion

CREATE TABLE TRANSACTION_24012011142 (
    Acc_no VARCHAR(5),
    Tr_date DATE,
    Amt DECIMAL(10, 2),
    Type_of_tr CHAR(1),
    Mode_of_pay VARCHAR(30)
);

INSERT INTO TRANSACTION_24012011142 (Acc_no, Tr_date, Amt, Type_of_tr, Mode_of_pay) VALUES 
('A001', '2021-05-01', 10000.00, 'D', 'Cash'),
('A002', '2021-07-02', 5000.00, 'W', 'Cheque'),
('A003', '2021-08-03', 25000.00, 'D', 'Cheque'),
('A004', '2021-05-04', 30000.00, 'D', 'Cheque'),
('A005', '2021-10-05', 15000.00, 'W', 'Cash');

-- 1.
SELECT * FROM TRANSACTION_24012011142;
SELECT SUM(Amt) AS Total_Amount FROM TRANSACTION_24012011142;
-- 2.
SELECT MIN(Amt) AS Minimum_Amount FROM TRANSACTION_24012011142;
-- 3.
SELECT MAX(Amt) AS Maximum_Amount FROM TRANSACTION_24012011142;
-- 4.
SELECT COUNT(*) AS Total_Transactions FROM TRANSACTION_24012011142;
-- 5.
SELECT COUNT(*) AS Cheque_Transactions FROM TRANSACTION_24012011142 WHERE Mode_of_pay = 'Cheque';
-- 6.
SELECT COUNT(*) AS Not_Deposit_Transactions FROM TRANSACTION_24012011142 WHERE NOT Type_of_tr = 'D';
-- 7.
SELECT COUNT(*) AS May_Transactions FROM TRANSACTION_24012011142 WHERE DATE_FORMAT(Tr_date, '%m') = '05';
-- 8.
SELECT AVG(Amt) AS Average_Amount FROM TRANSACTION_24012011142;
-- 9.
SELECT POWER(4, 4) AS Power_Value FROM DUAL;
-- 10.
SELECT SQRT(25) AS Square_Root FROM DUAL;
-- 11.
SELECT
    LOWER('Hello World') AS lower_case,
    UPPER('Hello World') AS upper_case,
    SUBSTR('Hello World', 7, 5) AS sub_string,
    LENGTH('Hello World') AS text_length,
    LTRIM('  Hello World  ') AS left_trim,
    RTRIM('  Hello World  ') AS right_trim,
    LPAD('SQL', 8, '*') AS left_pad,
    RPAD('SQL', 8, '-') AS right_pad
FROM DUAL;